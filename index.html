<html lang="en">

<head>
  
  <meta charset="UTF-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>DOLLAR SURVEY</title>

  <link rel="stylesheet" href="homepage-style.css" />

  <style>

  </style>

</head>

<body>
    <div class="user-info">
  <a href="login.html">login</a>
</div>

    <div class="hamburger" onclick="toggleMenu()">
  <span></span>
  <span></span>
  <span></span>
</div>


  <header>
    <div class="menu-container">
  
  <div id="menu-dropdown" class="menu-dropdown">
    <a href="register.html">Register</a>
    <a href="login.html">login</a>
    <a href="about.html">About</a>
    <a href="contact.html">contact-us</a>
    <a href="faqs.html">FAQS</a>
  </div>
</div>


    <div id="title"><h1>DOLLAR SURVEY</h1></div>
    
    <div id="subtitle"><h2>Welcome to Dollar Survey</h2></div>
<h4>start By Answering Surveys Below</h4>

    </div>
    

  </header>
  <div class="referral-section">
  <span id="referral-link">https://dollarsurveys.netlify.app</span>
  <button onclick="shareReferral()">Share Link</button>
  
</div>

</div>

<script>
function shareReferral() {
  const referralUrl = document.getElementById('referral-link').textContent;

  if (navigator.share) {
    navigator.share({
      title: 'Join Dollar Survey',
      text: 'Sign up using my referral link and earn money from surveys:',
      url: referralUrl
    }).catch((err) => {
      console.error('Share failed:', err);
      fallbackCopy(referralUrl);
    });
  } else {
    fallbackCopy(referralUrl);
  }
}

function fallbackCopy(text) {
  navigator.clipboard.writeText(text).then(() => {
    alert("Referral link copied to clipboard!");
  }).catch(err => {
    console.error('Clipboard copy failed:', err);
    alert("Failed to copy link. Please copy it manually.");
  });
}

  function toggleMenu() {
    var menu = document.getElementById("menu-dropdown");
    menu.classList.toggle("show");
  }
</script>
<div>
 <p class="survey-question">1. Sarah joined Dollar Survey a week ago. She spent 15 minutes each day answering questions honestly and already earned a few dollars. She said it was the easiest way she had ever earned online. What motivated Sarah to continue using the platform?</p>
<input type="text" class="survey-answer" placeholder="required" />

<p class="survey-question">2. James told his friends about Dollar Survey and invited them through his referral link. A few days later, he noticed his balance increased without answering any new questions. How do referrals help users earn more on the platform?</p>
<input type="text" class="survey-answer" placeholder="required" />

<p class="survey-question">3. Dollar Survey added new features like withdrawal tracking and live balance updates. Rita, a frequent user, found it easier to see her progress and trust the platform more. Why do you think transparency is important in online earning platforms?</p>
<input type="text" class="survey-answer" placeholder="required" />

<p class="survey-question">4. Kelvin completed surveys every evening after school. Within a month, he earned over $50 and planned to use it to buy books. How can Dollar Survey support students in real life?</p>
<input type="text" class="survey-answer" placeholder="required" />

<p class="survey-question">5. Ada always answered surveys with thoughtful and genuine responses. She noticed her balance increased steadily compared to when she rushed through questions. Why is it important to give authentic answers in surveys?</p>
<input type="text" class="survey-answer" placeholder="required" />

  <button onclick="submitFullSurvey()">Submit Survey</button>
</div>


<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
  import { getFirestore, collection, addDoc, doc, setDoc, getDoc, updateDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-firestore.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDnq2364tMuRPbrjjHmUfFUTjWZC2BmIS4",
    authDomain: "dollar-survey-60fe7.firebaseapp.com",
    projectId: "dollar-survey-60fe7",
    storageBucket: "dollar-survey-60fe7.appspot.com",
    messagingSenderId: "293471697208",
    appId: "1:293471697208:web:664863f09e830e420c69cd"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const auth = getAuth(app);

  let userCountry = "Unknown";

  fetch("https://ipapi.co/json")
    .then(res => res.json())
    .then(data => {
      userCountry = data.country_name || "Unknown";
    });

  // Show user info live
  onAuthStateChanged(auth, async (user) => {
    if (user) {
      document.getElementById("user-email").textContent = `User: ${user.email || 'Anonymous'}`;
      const userRef = doc(db, "users", user.uid);
      const userSnap = await getDoc(userRef);
      const balance = userSnap.exists() ? userSnap.data().balance || 0 : 0;
      document.getElementById("user-balance").textContent = `Balance: $${balance.toFixed(2)}`;
    }
  });

  // Survey submission
  window.submitFullSurvey = async function () {
    const answerEls = document.querySelectorAll(".survey-answer");
    const questionEls = document.querySelectorAll(".survey-question");

    const allAnswered = Array.from(answerEls).every(el => el.value.trim() !== "");
    if (!allAnswered) {
      alert("Please answer all questions before submitting.");
      return;
    }

    const responses = {};
    questionEls.forEach((qEl, idx) => {
      responses[qEl.innerText] = answerEls[idx].value.trim();
    });

    const user = auth.currentUser;
    const uid = user?.uid || "anonymous";
    const email = user?.email || "anonymous@user.com";

    try {
      // Save survey response
      await addDoc(collection(db, "submittedSurveys"), {
        userId: uid,
        email: email,
        responses: responses,
        country: userCountry,
        timestamp: serverTimestamp()
      });

      // Update balance
      const userRef = doc(db, "users", uid);
      const userSnap = await getDoc(userRef);
      const currentBalance = userSnap.exists() ? userSnap.data().balance || 0 : 0;
      const newBalance = currentBalance + 0.5;

      await setDoc(userRef, { balance: newBalance }, { merge: true });

      document.getElementById("user-balance").textContent = `Balance: $${newBalance.toFixed(2)}`;

      alert("Survey submitted. Balance updated!");
      answerEls.forEach(el => el.value = "");

    } catch (err) {
      console.error("Error:", err);
      alert("Survey submission failed.");
    }
  };
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1947981398780941"
     crossorigin="anonymous"></script>

</body>

</html>



